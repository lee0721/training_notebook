# -*- coding: utf-8 -*-
"""basketball_ball_training.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ipNs1E2-WH9yQRrOvhD0cihM0EQ6hvDy
"""
from roboflow import Roboflow
rf = Roboflow(api_key="qxXvlNarIRl13bYsGauo")
project = rf.workspace("workspace-5ujvu").project("basketball-players-fy4c2-vfsuv")
version = project.version(17)
dataset = version.download("yolov8")

# å°å‡º data.yaml ç¢ºèªè³‡æ–™è·¯å¾‘
print("ğŸ“‚ Dataset è·¯å¾‘ï¼š", dataset.location + "/data.yaml")

# ä½¿ç”¨ YOLOv8x.pt é–‹å§‹è¨“ç·´
from ultralytics import YOLO

model = YOLO("yolov8x.pt")  # âœ… YOLOv8 ç²¾åº¦æœ€é«˜ç‰ˆæœ¬

model.train(
    data=f"{dataset.location}/data.yaml",  # ä½¿ç”¨ Roboflow ä¸‹è¼‰çš„æ­£ç¢ºè·¯å¾‘
    epochs=300,
    imgsz=1280,  # æ”¾å¤§è¼¸å…¥è§£æåº¦å¹«åŠ©åµæ¸¬å°çƒ
    batch=8,
    name="basketball_ball_yolov8x"
)

import shutil
shutil.copy("runs/detect/basketball_ball_yolov8x/weights/best.pt", "training_notebook/ball_best.pt")