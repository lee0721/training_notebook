# -*- coding: utf-8 -*-
"""basketball_player_detection_training.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1jrE2x7pS6e8bdB-ME3OJeuiH5orCiYk7
"""

# å®‰è£å¿…è¦å¥—ä»¶
!pip install -q ultralytics roboflow

from roboflow import Roboflow
rf = Roboflow(api_key="qxXvlNarIRl13bYsGauo")
project = rf.workspace("workspace-5ujvu").project("basketball-players-fy4c2-vfsuv")
version = project.version(17)
dataset = version.download("yolov8")

# å°å‡º data.yaml è·¯å¾‘ç¢ºèª
print("ğŸ“‚ Dataset è·¯å¾‘ï¼š", dataset.location + "/data.yaml")

# è¼‰å…¥ YOLOv8x æ¨¡å‹ä¸¦é–‹å§‹è¨“ç·´
from ultralytics import YOLO

model = YOLO("yolov8x.pt")  # ä½¿ç”¨ YOLOv8xï¼Œç²¾åº¦æœ€é«˜ âœ…

model.train(
    data=f"{dataset.location}/data.yaml",  # è‡ªå‹•æŠ“ Roboflow è³‡æ–™é›†è·¯å¾‘
    epochs=200,
    imgsz=1280,  # æ”¾å¤§è§£æåº¦ï¼Œæœ‰åŠ©æ–¼åµæ¸¬å°ç›®æ¨™ï¼ˆå¦‚çƒå“¡æ‰‹ã€é ­ç­‰ï¼‰
    batch=8,     # å¦‚æœ GPU å¤ å¤§å¯èª¿é«˜
    name="basketball_players_yolov8x"
)

import shutil
shutil.copy("runs/detect/basketball_players_yolov8x/weights/best.pt", "training_notebook/player_best.pt")